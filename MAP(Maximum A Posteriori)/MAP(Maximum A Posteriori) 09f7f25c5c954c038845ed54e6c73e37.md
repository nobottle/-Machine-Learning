# MAP(Maximum A Posteriori)

1. MLE와 MAP를 알기 위해서는 **Posterior, Prior, Likelihood**에 대해 이해해야 한다.

2. MLE는 **Likelihood**를, MAP는 **Posterior**를 최대화(**Maximize**)한다.

3. MLE와 MAP는 수식적으로 연관성이 높다. MLE는 관측치에 영향을 많이 받고 MLE는 MAP의 특수한 형태이다.

베이즈 이론

![스크린샷 2023-03-22 오후 3.29.42.png](MAP(Maximum%20A%20Posteriori)%2009f7f25c5c954c038845ed54e6c73e37/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-22_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_3.29.42.png)

은 이거인데 기초적으로 확률에 대해서 정리해야할 것이 잇다

**사전확률**

p(A)

사건 B가 발생하기 전,사건 A의 확률을 의미. ex)환자가 당뇨병일 확률을 P(A)로 표현 가능

**사후확률**

p(A|B)

사건 B가 발생한 후 수정된 A의 확률을 의미 “사전확률”인 사건 A가 B라는 사건에 영향을 받은 경우를 표현하기위해 “사후확률”이라는 명칭이 사용 ex)환자가 당뇨진단을 받은 경우,실제 당뇨병일 확률을p(A|B)라고 나타냄

**조건부확률**

![스크린샷 2023-03-22 오후 3.51.11.png](MAP(Maximum%20A%20Posteriori)%2009f7f25c5c954c038845ed54e6c73e37/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-22_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_3.51.11.png)

사건 B가 발생한 후 수정된 A의 확률을 의미 사후확률과 동일한 수식,그러나 사건들의 교집합에 개별 사건을 나눈 결과로 표현할 수 있다는 것을 의미하기 위해 사용

![스크린샷 2023-03-22 오후 3.52.24.png](MAP(Maximum%20A%20Posteriori)%2009f7f25c5c954c038845ed54e6c73e37/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-22_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_3.52.24.png)

![스크린샷 2023-03-22 오후 3.54.11.png](MAP(Maximum%20A%20Posteriori)%2009f7f25c5c954c038845ed54e6c73e37/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-22_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_3.54.11.png)

베이즈 정리 수식으로 돌아와서 정리하면

![스크린샷 2023-03-22 오후 3.55.03.png](MAP(Maximum%20A%20Posteriori)%2009f7f25c5c954c038845ed54e6c73e37/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-22_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_3.55.03.png)

자세히 보면 조건부확률식을 이용하여 사후확률을 구하고 있다

참고로 P(B|A)부분을 가능도(likelihood) 또는 우도라고 표현한다.

![스크린샷 2023-03-22 오후 4.01.49.png](MAP(Maximum%20A%20Posteriori)%2009f7f25c5c954c038845ed54e6c73e37/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-22_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_4.01.49.png)

확장을 한번 해보자

![스크린샷 2023-03-22 오후 4.02.15.png](MAP(Maximum%20A%20Posteriori)%2009f7f25c5c954c038845ed54e6c73e37/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-22_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_4.02.15.png)

그렇다면

![스크린샷 2023-03-22 오후 4.03.51.png](MAP(Maximum%20A%20Posteriori)%2009f7f25c5c954c038845ed54e6c73e37/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-22_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_4.03.51.png)

이렇게 정리가 가능 글이 보기쉽게 잘 예시가 들어있다 차근히 보면서 암기하자

다시 돌아와서

![스크린샷 2023-03-22 오후 3.29.42.png](MAP(Maximum%20A%20Posteriori)%2009f7f25c5c954c038845ed54e6c73e37/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-22_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_3.29.42.png)

posterior

위 식의 좌변으로 관측치x가 주어졌을 때 theta를 가지는 확률이다

prior

우변의 p로 theta로 구성된 확률모형

관측치 x를 통해 특정하고자 하는 함수

**대부분의 현실적 Application의 경우 함수의 본모습을 파악하는것이 사실상 불가능 (분포가 알려지지 않았거나, 데이터가 부족하거나…)**

그래서 분포를 미리 정해두는것(Prior Distribution)

따라서 Prior는 분석가의 개입의 여지가 가장 큰 확률분포. 같은 문제라도 서로 다른 prior를 사용하여 접근할 수 있다는 의미가 됨

likelihood

우변의 p(x|theta)로 Likelihood라고 일컫는 이 분포는 posterior와 정 반대로 parms이 주어졌을때 x 관측치를 얻을 확률을 말함

즉, 주어지는 parms에 따라서 관측치를 얻을수 있는 확률을 나타내는 모형이라고 할 수 있음. posterior와 생긴것이 정 반대

즉 베이즈 이론은 결국 Posterior = Prior * Likelihood / (const) 로 전개

---

**그렇다면 MLE와 MAP에 대해서는?**

MLE와 MAP는 각각 Likelihood와 Posterior를 Maximize시켜 추정치를 얻는 방법론

그렇다면 정확히 어떻게 다른걸까?

ex)

지나가다 지갑을 주워 경찰서에 돌려주고 연락처를 남겼습니다.

지갑을 주운 사람은 오랜기간 솔로라 지갑의 주인이 이성이었으면 좋겠다고 생각합니다.

그래서 구글에서 한국 남여 성비와 지갑 구매자의 성비를 조사합니다.

지갑의 주인이 이성일 확률은 얼마일까요?

이에 대해 MLE, MAP의 해석 관점은 다릅니다.

MLE는 이 확률을 단순히 남,여 중에서 해당 지갑을 가지고 있는 확률이라고 답합니다.

즉, 주어진 현상을 가지고 현상이 추출될 가능성을 가장 높게하는 모수(위 예제는 지갑)를 거꾸로 추적합니다.

![https://miro.medium.com/v2/resize:fit:672/1*oTWCeu1LdA8s-TXDN7E_yg.png](https://miro.medium.com/v2/resize:fit:672/1*oTWCeu1LdA8s-TXDN7E_yg.png)

이런식으로 쉽게 이해가능

반면에 MAP는 남여 지갑 소유비율(Likelihood)과 남여 성비(prior)를 같이 고려해 확률을 구합니다.

즉, 주어진 현상과 더불어 사전 지식(위 예제에서는 한국 남여 성비)을 함께 적용합니다.

수식으로 표현하자면, 다음과 같습니다.

MLE : P(지갑|남자), P(지갑|여자) 의 확률을 비교하자(=가장 큰 Likelihood를 비교하자)

남자가 지갑을 가지고 있을 확률,여자가 지갑을 가지고 있을 확률

MAP : P(남자|지갑), P(여자|지갑) 의 확률을 비교하자(=가장 큰 Posterior를 비교하자)

지갑을 가지고 있는데 남자일 확률,여자일 확률>>지갑을 가지고 있는 비율도 생각

MLE의 수식

![스크린샷 2023-03-22 오후 4.29.32.png](MAP(Maximum%20A%20Posteriori)%2009f7f25c5c954c038845ed54e6c73e37/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-22_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_4.29.32.png)

MLE는 관측결과에 민감,그래서 관측의 양과질에 크게 좌우됨

if여러번 동전을 던져 모두 앞면만 나오면 MLE는 이 동전이 앞면만 나온다고 말할 것

MAP의 수식

![스크린샷 2023-03-22 오후 4.30.34.png](MAP(Maximum%20A%20Posteriori)%2009f7f25c5c954c038845ed54e6c73e37/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-22_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_4.30.34.png)

실제 사전 확률이 반영된 추정치를 얻을 수 있고 이를 통해 MLE보다 합리적인 방법론으로 통핤 수 있음

만약 Prior가 Uniform Distribution인 경우에는 어떻게 될까요?(균일분포일경우)

![스크린샷 2023-03-22 오후 4.32.37.png](MAP(Maximum%20A%20Posteriori)%2009f7f25c5c954c038845ed54e6c73e37/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-03-22_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_4.32.37.png)

prior값은 constant(상수)로 치환됨

결국 MAP가 MLE로 돌아옴

즉 MLE는 MAP의 특수한 경우 >>아까 예시를 든 경우

![Screenshot_20230322-165706.png](MAP(Maximum%20A%20Posteriori)%2009f7f25c5c954c038845ed54e6c73e37/Screenshot_20230322-165706.png)

![Screenshot_20230322-165722.png](MAP(Maximum%20A%20Posteriori)%2009f7f25c5c954c038845ed54e6c73e37/Screenshot_20230322-165722.png)

![Screenshot_20230322-165732.png](MAP(Maximum%20A%20Posteriori)%2009f7f25c5c954c038845ed54e6c73e37/Screenshot_20230322-165732.png)